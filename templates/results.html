<html>
<head>
    <meta name="viewpoint" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<link rel="stylesheet" href="./static/search.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
	<script>
	
	</script>
</head>
<body>
     <div class="navbar">
        <ul>
        <li><a href="/home"><i class="fa fa-home"></a></i></li>
        <li><a href="#"><i class="fa fa-save"></i></a></li>
        <li><a href="/settings"><i class="fa fa-gear"></a></i></li>
		<form id= "search" action="/search1" method="GET">
		<li><a  id="f"
		  style="background-color#cac7ff" aria-hidden= "true" class="fa fa-search"></a></li>
		
		<li>
		<div class= "tooltip">
		<span class="tooltiptext"> 
			For users 'user : [username]'
			For groups 'group: [groupname]'
			Groups by description 'gdesc : [keywords]'
		</span>
		
		<input placeholder= "search anything" style= "background-color: #5E3023;
		border-radius: 60px; position: absolute; right: 1px ; top: 9px ; padding: 10px 30px; backdrop-filter: blur(4px) saturate(180%);" 
		type="search1" id="form1" class="form-control" name= "query"/>
		
		</div>
		</li>
       
		</form>
		</ul>
		<script>
		
		//Creates index for user chats
		var selected= 0;
		function getEventTarget(e) {
		e = e || window.event;
		return e.target || e.srcElement; 
		}
		function getIndexOfChat() {
			let target = getEventTarget(event);
			let a = target.closest('a'); // get reference by using closest
			let nodes = Array.from( a.closest('div').children ); // get array
			let index = nodes.indexOf( a ); 
			selected= index;
			console.log(selected);
			return selected;
		};
		document.getElementById("f").onclick = function() {
		document.getElementById("search").submit();
		}
		
	</script>
    </div>  
	Search results: {{len}} found
	<br><br><br><br>
	<!-- For loop for user search results -->
	{%for i in range(0, len)%}
		<h4>{{results[i].username}}
		</h4>
		<br>
	{%endfor%}
	<!-- For loop for group search results -->
	
	  {%for i in range(0, len)%}
	  
		<div class="card" style="width: 18rem;">
		<img class="card-img-top" id="pp" src="/static/uploads/{{results[i].photo}}">
			<div class="card-body">
			<h5 class="card-title">{{results[i].name}}</h5>
			<p class="card-text">{{results[i].description}}</p>
			<div class="card-body">
				<a href="#" id= "join" class="card-link">Join Group</a>
				<a href="#" class="card-link">Exit</a>
		</div></div>
	  </div>
	  <br>
	{%endfor%}

	<script>
		function createItemTemplate(item) {
  
  const img= document.createElement("img");
  img.classList.add('card-img-top');
  //Placeholder until I add correct parse for results
  img.src= "/static/uploads/defg.png";
  
  return img;
}
		// When the user clicks on div, open the popup
		document.getElementById("join").onclick= function() {
			alert(getIndexOfChat());
		}
	</script>
	
	
</body>
</html>